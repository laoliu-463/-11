一、设有三个关系如下图所示
R		S		T
A	B	C		A	B	C		B	C	D
1	2	3		1	2	3		1	2	4
4	5	6		3	4	5		5	6	7
5	6	7		7	8	9		5	6	8
7	8	9						7	8	9

计算、、R−S、、、、、
以下第二、三大题要用到的数据库（SPJ）表及其结构描述如下：
 设备供应商  S（SNO，SNAME，STATUS，CITY）
零件  P（PNO，PNAME，COLOR，WEIGHT）
工程项目  J（JNO，JNAME，CITY）
供应情况  SPJ（SNO，PNO，JNO，QTY）
表名：S（设备供应商）
字 段 名	SNO	SNAME	STATUS	CITY
数据类型	char	char	char	char
长    度	10	12	2	8
描    述	供应商编号	供应商名称	供应状态	所在城市
表名：P（零件）
字 段 名	PNO	PNAME	COLOR	WEIGHT
数据类型	char	char	char	Integer
长    度	10	12	5	
描    述	零件编号	零件名称	零件颜色	零件重量
表名：J（工程项目）
字 段 名	JNO	JNAME	CITY
数据类型	char	char	char
长    度	10	10	8
描    述	工程编号	工程名	所在城市
表名：SPJ（供应情况）
字 段 名	SNO	PNO	JNO	QTY
数据类型	char	char	char	Integer
长    度	10	10	10	
描    述	供应商编号	零件编号	工程编号	供应数量

二、试用关系代数表达式表示下列查询语句
1. 检索颜色为红色且重量超过50克的零件的零件名；
2. 检索项目“三建”使用的零件编号和零件名；
3. 查询没给任何工程项目供应零件的供应商名；
4. 查询至少使用两种以上零件的工程项目号。
三、使用T-SQL完成下列操作
1.创建SPJ表，设置供应商编号、零件编号和工程编号一起做主键，且各自分别为外键参照供应商表、零件表和工程项目表的对应编号；
2.向spj表插入一条新纪录，供应商为：s8 零件号为：p8 工程号为：j8 数量为100
3.将所有红色零件的重量加5克；
4.删除所有上海的工程项目信息；
5.建立一个供应情况的视图v_spj，视图中包括供应商名、项目名，零件名和供应数量，给每一列都起一个中文名字；
6.建立一个视图v_ssum，在视图中统计每个项目的供应商数量，给出项目名和供应商数量；
7.为供应商表建立唯一索引，要求按照供应商名升序索引；
8.查询所有供应商的姓名和所在城市；
9.查询重量大于50g的所有红色零件的名称；
10.查询工程编号以“J210_”开头的所有工程的工程号和所在城市；
11.查询没给任何工程供应零件的设备供应商号；
12.查询使用供应商S1（供应商号）所供应零件的工程号码；
13.查询工程J2（工程编号）使用的各种零件的名称及其数量，并按数量降序排序；
14.查询上海厂商供应的所有零件编号；（要求使用子查询完成）
15.查询使用上海产的零件的工程名称；
16.查询上海供应商的数量；
17.查询每个城市的工程数量，给出城市名和数量；
18.查询每项工程使用的零件总数，给出工程名和零件的总数；
19.查询使用3种以上零件的工程号；
20.编写一个存储过程p_scity，给定一个城市，返回该城市所有供应商信息；调用该存储过程。
21.编写一个存储过程p_jsum，给定一个供应商编号，查询由他供应零件的项目数量，将其以参数形式返回；调用该存储过程。
22.编写一个存储过程p_pqty，给定一个零件名，查询该种零件的总供应量，若该数量低于50则提示用户该种零件属于滞销零件，否则提示用户该零件的总数；调用该存储过程。
23.创建供应商表S上的触发器tr_ins_s，当对S表进行插入时触发，提示用户已经插入表中的行数；
24.创建零件表p上的触发器tr_ins_p，当向表S中插入新行时，如果是红色零件且重量超过50克，则撤销该插入操作并提示用户操作失败；触发该触发器。
25.创建一个触发器tr_spj，当插入或更新spj表时触发，判断若该项目使用的零件总数超过500个，则拒绝此次插入或更新。触发该触发器。

四、应用题
1. 设有关系模式R（EmpNo，TDate，DAmount，Dept，Manager）属性分别表示职工编号，日期，日营业额，部门名，部门经理，该模式统计商店里每个职工的日营业额，以及职工所在的部门和经理信息。
现规定：每个职工每天只有一个营业额；
每个职工只在一个部门工作；
每个部门只有一个经理。
试回答下列问题：
（1）根据上述规定，写出关系模式R的基本函数依赖。
（2）找出关系模式R的候选键。
（3）判断关系模式R最高达到第几范式，说明理由。
（4）若关系模式R不属于3NF，将其分解成3NF模式集（只需要分解的结果）。

2.设某商业集团数据库中有四个实体集。一是“商店”实体集，属性有商店编号、商店名、地址等；二是“商品”实体集，属性有商品编码、商品名、规格、单价等；三是“职工”实体集，属性有职工编号、姓名、性别、业绩等；四是商品 “类别”实体集，属性有类别编号，类别名称等。
商店与商品间存在“销售”联系，每个商店可销售多种商品，每种商品也可放在多个商店销售，销售有销售量属性；商店与职工间存在着“聘用”联系，每个商店有许多职工，每个职工只能在一个商店工作，商店聘用职工有聘期和月薪；一个商品类别可以包含多个商品。
（1）试画出E-R图，并在图上注明属性、联系的类型。
（2）再转换成关系模式集，要求关系模式尽可能少。
（3）指出每个关系模式的主键和外键。

