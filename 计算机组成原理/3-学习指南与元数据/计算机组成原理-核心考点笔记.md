# 计算机组成原理 - 核心考点复习笔记
> **简介**：本笔记基于习题集 `101` (I/O), `102` (内存), `103` (综合), `104` (期末) 整理而成，按知识模块重组，旨在实现“知识点-习题”的精准映射。
> **适用范围**：期末复习、考研复习
> **最后更新**：2025年1月

[TOC]

---

## 模块一：数据的表示与运算 (Data Representation & Arithmetic)
> **对应习题**：`103`, `104`

### 1.1 整数表示 (Integer)
*   **原码 (Sign-Magnitude)**：
    *   **定义**：最高位符号 (0正1负)，其余为绝对值。
    *   **范围 (n+1位)**：$-(2^n - 1) \sim +(2^n - 1)$。
    *   **特点**：有两个0 (+0, -0)，加减运算复杂。
*   **补码 (Two's Complement)**：
    *   **定义**：正数不变，负数取反加一。
    *   **范围 (n位)**：$-2^{n-1} \sim +(2^{n-1} - 1)$。
    *   **特点**：只有一个0，减法变加法。
    *   **机器数运算 (103-Q4)**：
        *   $x = \text{FFFFFFDFH} (-33)$, $y = 00000041\text{H} (65)$。
        *   $x - y = -98 \to \text{FFFFFF9EH}$。
*   **C语言类型转换 (103-Q3)**：
    *   `short` (-32767) $\to$ `unsigned short`。
    *   **规则**：位模式不变，解释方式改变。
    *   `1000...0001` (补码) $\to$ 无符号数 $32769$。

### 1.2 溢出判断 (Overflow)
*   **定义**：运算结果超出了机器数所能表示的范围。
*   **补码溢出规则 (103-Q1)**：
    *   **正+正=负** (正溢出)。
    *   **负+负=正** (负溢出)。
    *   *注*：正+负 永远不会溢出。

### 1.3 浮点数 (IEEE 754)
*   **格式 (32位单精度)**：1位符号(S) + 8位阶码(E) + 23位尾数(M)。
*   **计算公式**：$V = (-1)^S \times 1.M \times 2^{E-127}$。
*   **例题 (104-Q6)**：
    *   $-0.4375 = -7/16 = -1.11 \times 2^{-2}$。
    *   S=1。
    *   E = -2 + 127 = 125 = `01111101`。
    *   M = `11000...` (去掉隐含的1)。
    *   Hex: `BEE00000H`。

---

## 模块二：存储系统 (Memory System)
> **对应习题**：`102`, `104`

### 2.1 存储层次结构 (Hierarchy)
*   **金字塔 (104-Q3)**：寄存器 > Cache > 主存 > 辅存。
*   **CPU 访问权限 (102-Q11)**：
    *   **可直接访问**：寄存器、Cache、主存。
    *   **不可直接访问**：辅存 (硬盘)，必须先加载到主存。
*   **虚拟内存 (102-Q12)**：
    *   **目的**：扩大**逻辑**存储空间，解决主存容量不足的问题。

### 2.2 主存储器 (Main Memory)
*   **SRAM vs DRAM (102-Q16)**：
    *   **SRAM**：快、贵、不用刷新 $\to$ **Cache**。
    *   **DRAM**：慢、便宜、需刷新 $\to$ **主存**。
*   **ROM 类型 (102-Q14)**：
    *   **PROM**：一次性写入 (不可更改)。
    *   **EPROM/Flash**：可擦写。
*   **容量与寻址计算**：
    *   **地址线/数据线 (102-Q15)**：$32K \times 16$位 $\to$ 15根地址线，16根数据线。
    *   **寻址范围 (102-Q1, Q8)**：
        *   32位地址 $\to$ 4G 空间。
        *   16MB 容量，半字(2B)寻址 $\to$ $16M/2 = 8M = 2^{23}$ 单元。
*   **存储扩展 (102-Q17)**：
    *   位扩展 (并联数据线) + 字扩展 (译码器片选)。
    *   4片 $16K \times 8$ $\to$ $32K \times 16$ (2并2串)。

### 2.3 高速缓存 (Cache)
*   **映射方式 (102-Q6, Q13)**：
    *   **直接映射 (Direct, K=1)**：僵化，冲突大。
    *   **全相联 (Fully Associative, K=M)**：灵活，成本高。
    *   **组相联 (Set Associative)**：折中。
*   **地址结构计算 (102-Q9)**：
    *   **公式**：Addr = Tag + Set + Offset。
    *   **Set** = $\text{BlockNum} \pmod{\text{Sets}}$。
    *   *例*：16行2路 $\to$ 8组。地址129 (块4) $\to$ 组4。
*   **写策略 (102-Q10, 104-Q4)**：
    *   **通写式 (Write-through)**：同时写 Cache 和主存 (简单，慢)。
    *   **写回式 (Write-back)**：只写 Cache，替换时才写回 (快，复杂，Dirty位)。

### 2.4 辅助存储器 (Auxiliary Memory)
*   **磁盘性能 (104-Q5)**：
    *   **寻道时间 (Seek Time)**：最耗时 (机械臂移动)。
    *   **旋转延迟**：等扇区转过来。
    *   **传输时间**：读写数据。
*   **RAID (104-Q25)**：
    *   **RAID 0**：条带化 (快，无冗余)。
    *   **RAID 1**：镜像 (安全，贵)。
    *   **RAID 5**：分布式校验 (均衡)。

---

## 模块三：指令系统与 CPU (Instruction & CPU)
> **对应习题**：`103`, `104`

### 3.1 指令系统基础
*   **冯·诺依曼架构 (102-Q2, 104-Q1)**：
    *   存储程序、二进制、顺序执行。
    *   指令和数据同等地位 (通过访问阶段区分)。
*   **字长 (102-Q4)**：CPU 一次处理的位数 (如 32位)。
*   **指令周期 (102-Q3)**：最简 = 取指 + 执行。

### 3.2 寻址方式
*   **常见方式**：
    *   **立即寻址**：数在指令里 (快)。
    *   **直接寻址**：地址在指令里。
    *   **间接寻址**：地址的地址 (慢)。
    *   **寄存器间接寻址**：地址在寄存器里 (较快)。
*   **PC (程序计数器) (103-Q6)**：永远指向**下一条**指令。

### 3.3 CPU 结构与流水线
*   **流水线 (Pipeline)**：
    *   **目标**：提高指令吞吐率 (Throughput)。
    *   **限制**：数据冒险、控制冒险 (分支指令)。

---

## 模块四：I/O 系统 (I/O System)
> **对应习题**：`101`, `104`

### 4.1 I/O 控制方式
*   **程序查询 (Polling)**：CPU 忙等，效率低。
*   **中断驱动 (Interrupt)**：
    *   CPU 与外设并行。
    *   I/O 完成时发 **INTR** 信号。
    *   **响应时机 (101-Q15)**：指令执行周期结束。
    *   **堆栈作用 (101-Q8)**：保存 PC 和 PSW (恢复现场)。
*   **DMA (直接存储器访问) (101-Q2, Q9, Q11)**：
    *   **特点**：硬件接管总线，CPU 不干预数据传输。
    *   **效率**：仅在开始/结束时中断 CPU (块传输)。
    *   **优先级**：DMA > 中断。

### 4.2 中断系统进阶
*   **中断判优 (101-Q7)**：解决并发冲突。
*   **中断掩码 (101-Q14)**：
    *   **作用**：动态改变处理顺序 (非响应顺序)。
    *   **设置原则**：屏蔽自己 +屏蔽低优先级。
*   **接口寄存器 (101-Q5)**：
    *   状态 (Status)、控制 (Control)、数据 (Data)。
    *   *注*：没有 IR/MAR (那是 CPU 的)。

### 4.3 总线 (Bus)
*   **数据总线 (101-Q12)**：传输 数据、命令、状态、中断号。
*   **总线控制**：同一时刻只能有一个主设备 (Master)。

---

## 模块五：综合大题精选 (Comprehensive)
> **对应习题**：`111`, `113` (补充)

### 5.1 海明码 (Hamming Code)
*   **校验位位置**：$1, 2, 4, 8...$ ($2^k$)。
*   **纠错原理**：利用奇偶校验位指出出错位置 (Syndrome)。

### 5.2 MESI 协议
*   **Cache 一致性**：解决多核 Cache 数据同步问题。
*   **状态**：Modified, Exclusive, Shared, Invalid。
*   **写失效 (Write-Invalidate)**：写时通知别人作废。
