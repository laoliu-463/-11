# 11-指令分类：硬件功能清单

> **核心视角**：指令集 (ISA) 是 CPU 提供的**标准函数库**。虽然指令成千上万，但归根结底，它们只做三件事：**搬运数据**（Move）、**变换数据**（Compute）、**改变执行流**（Control）。
> 最后更新：2025年1月

---

## 一、数据传送指令 (Data Transfer)：搬运工

这类指令负责在**寄存器**、**内存**和**I/O 端口**之间移动数据状态。它们**不改变**数据的内容，只改变数据的位置。

*   **MOV**：寄存器 $\leftrightarrow$ 寄存器，或 立即数 $\rightarrow$ 寄存器。
*   **LOAD (LW)**：内存 $\rightarrow$ 寄存器。这是 CPU 获取外部数据的唯一途径（在 RISC 中）。
*   **STORE (SW)**：寄存器 $\rightarrow$ 内存。这是 CPU 修改外部状态的唯一途径。
*   **PUSH / POP**：栈操作。本质上是特殊的 LOAD/STORE，附带了 SP 指针的自动修改。

## 二、运算指令 (ALU Operations)：加工厂

这类指令负责**变换**数据状态。它们是 CPU 产生新信息的源泉。

### 1. 算术运算 (Arithmetic)
*   **ADD / SUB**：加减法。最基础的状态变换。
*   **MUL / DIV**：乘除法。通常由专门的硬件单元实现，周期较长。
*   **INC / DEC**：自增/自减。循环变量的常用操作。

### 2. 逻辑运算 (Logical)
*   **AND / OR / XOR / NOT**：位操作。用于掩码、标志位处理。
*   **TEST / CMP**：比较指令。本质上是做减法或 AND 运算，但**不保存结果**，只更新 **PSW (状态标志位)**，供后续跳转指令使用。

### 3. 移位运算 (Shift)
*   **SHL / SHR**：逻辑移位。
*   **SAL / SAR**：算术移位。

## 三、控制转移指令 (Control Flow)：调度员

这类指令负责修改 **PC (程序计数器)** 的值，从而改变程序的执行路径。

*   **JMP (Jump)**：无条件跳转。`PC = Target`。
*   **Branch (Bxx)**：条件跳转。根据 PSW 中的标志位（Z, N, C, V）决定是否跳转。
    *   `BEQ` (Equal): if Z==1 then Jump.
    *   `BGT` (Greater Than): if ... then Jump.
*   **CALL / RET**：函数调用与返回。
    *   `CALL`：先将返回地址压栈（保存现场），再跳转。
    *   `RET`：从栈中弹出返回地址（恢复现场），赋值给 PC。

## 四、I/O 指令：外交官

*   **IN / OUT**：专门用于读写 I/O 端口（仅限独立编址的架构，如 x86）。
*   *注*：在统一编址架构（如 ARM）中，没有专门的 I/O 指令，使用 LOAD/STORE 访问特定内存地址即可。

---

## 五、总结

| 指令类别 | 核心功能 | 状态视角 | 典型占比 |
| :--- | :--- | :--- | :--- |
| **传送** | Copy | 状态位置的改变 | ~40% |
| **运算** | Compute | 状态内容的变换 | ~35% |
| **控制** | Branch | 执行流的改变 (PC) | ~20% |
| **I/O** | Input/Output | 与外部世界的交互 | ~5% |

理解指令分类，就是理解 CPU 这个**状态机**能够进行哪些基本操作。
