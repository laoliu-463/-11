# A1 计算机系统概述

> 计算机体系结构整体框架与性能视角  
> 涵盖原文：01-计算机体系结构概述、29-性能优化、30-综合应用  
> 最后更新：2025年1月

---

## 📑 目录

- [一、体系结构全景](#一体系结构全景)
- [二、性能指标与优化](#二性能指标与优化)
- [三、综合应用思维](#三综合应用思维)
- [四、快速复习清单](#四快速复习清单)

---

## 一、体系结构全景

### 1. 冯诺依曼 VS 哈佛
- **冯诺依曼结构**：指令和数据共享同一存储空间，控制器依次取指 → *优点*：结构简单；*缺点*：取指/访存冲突
- **哈佛结构**：指令、数据分离（现代CPU多为改进型哈佛） → *优点*：并行取指/访存；*缺点*：结构更复杂

### 2. 体系结构三层模型
```
┌──────────────┐  ISA：指令集架构      ← 程序员可见
│ 应用层       │  汇编指令、寄存器、地址空间
├──────────────┤
│ ISA层        │  程序设计接口、性能指标
├──────────────┤
│ 微体系结构层 │  流水线、乱序执行、预测
└──────────────┘
```
- **ISA**：定义“做什么”——指令格式、寻址方式、数据类型
- **微体系结构**：实现“怎么做”——流水线、缓存、控制逻辑
- **物理实现**：门电路、布局布线

### 3. 408考试视角
- **知识块**：数据/运算、指令系统、CPU、存储、I/O、系统性能
- **命题趋势**：综合题常涉及“完整分析链路”（指令 → CPU执行 → Cache ↔ 主存 → I/O）

---

## 二、性能指标与优化

### 1. 基础指标
| 指标 | 公式 | 说明 |
|------|------|------|
| CPI | `总时钟周期 / 指令数` | 每条指令平均时钟周期 |
| MIPS | `指令数 / 执行时间 / 10^6` | 百万指令吞吐率（受CPI、主频影响） |
| 性能 | `1 / 执行时间` | 性能 ∝ 1/延迟 |

### 2. Amdahl 定律
```
加速比 S = 1 / [(1 - P) + P / N]
```
- `P`：可并行部分比例，`N`：加速因子（处理器数、优化倍率）
- **核心结论**：提升受“串行部分”限制 → 优先优化热点串行段

### 3. 优化方向速览
- **硬件**：提高主频、扩展流水线深度、加大Cache、引入预测
- **编译器**：循环展开、指令调度、寄存器分配
- **软件**：算法改进、数据局部性、并行化
- **系统**：减少I/O瓶颈、优化存储层次、使用DMA

---

## 三、综合应用思维

### 1. 设计题常见套路
1. **需求分析**：吞吐 vs 延迟、功耗 vs 成本、实时性 vs 一致性
2. **体系结构选择**：指令集类型、流水线级数、Cache层次、I/O策略
3. **性能评估**：定量计算（CPI、命中率、带宽），提供优化方案

### 2. 典型综合题框架
```
输入             计算               输出
┌────────┐   ┌──────────┐   ┌────────┐
│ 指令流/数据 │→ │ CPU执行链路 │ →│ I/O设备 │
└────────┘   └──────────┘   └────────┘
   ↑              ↑                ↑
  编译优化       Cache/主存层次     DMA/中断
```
- 当题目给出“访存统计 + Cache命中率”时：先算访存次数，再算有效访问时间
- 当题目涉及“IO与CPU并行”时：关注 DMA / 中断对CPU占用的影响

### 3. 复习建议
- “概念 → 公式 → 应用”三段式速记卡片
- 整理一张“知识地图”：标出数据流、控制流、存储层次的交互

---

## 四、高频考题示例

### 例题1：性能计算
```
某CPU执行程序需要：
  • 指令数：1000条
  • 平均CPI：2
  • 时钟频率：2GHz

求：执行时间和MIPS

解答：
  时钟周期 = 1/2GHz = 0.5ns
  执行时间 = 1000 × 2 × 0.5ns = 1000ns = 1μs
  MIPS = 2GHz / (2 × 10^6) = 1000 MIPS
```

### 例题2：Amdahl定律
```
程序中30%可并行，70%串行
使用4个处理器并行化

求：加速比

解答：
  S = 1 / [(1-0.3) + 0.3/4]
    = 1 / [0.7 + 0.075]
    = 1 / 0.775
    ≈ 1.29倍
```

### 例题3：Cache性能
```
Cache访问时间：1ns，命中率90%
主存访问时间：100ns

求：平均访存时间

解答：
  AMAT = 1 + (1-0.9) × 100 = 1 + 10 = 11ns
  加速比 = 100/11 ≈ 9.1倍
```

---

## 五、快速复习清单

| 检查项 | ✓ | 备注 |
|--------|---|------|
| 记住 ISA 与微体系结构的区别 |   | 面试高频问题 |
| 掌握 CPI / 执行时间 / 性能三者关系 |   | 不同题型的单位要统一 |
| 会用 Amdahl 定律计算并行加速比 |   | 注意小数转换 |
| 能画出典型的存储层次结构 |   | 强化局部性理解 |
| 清楚 DMA、Cache、流水线的互相影响 |   | 综合题关键 |
| 掌握分支预测和流水线冒险 |   | 现代处理器重点 |

---

**温馨提示**：需要细节时回看原主题 `01、29、30` 的完整笔记。
